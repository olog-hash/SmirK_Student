# Информация о программе

Программа написана на .NET 6 и C# 10.
Framework для разработки выбран как ASP.NET Core Web API.
IDE: JetBrains Rider 2025.2

# Информация о задании (для практикантов и стажеров)

Реализовать механизм подбора водителя на заказ.

Карта представляет из себя прямоугольную сетку размером N x M, которая состоит из квадратов размером 1х1, в каждом из которых может находиться только один водитель.
Координаты расположения водителя или заказа представлены в виде простых чисел X и Y, где 0 <= X < N, 0 <= Y < M. 
Каждый водитель имеет уникальный идентификатор, который указывается при добавлении или изменении его координат.

В первой части необходимо реализовать три и более разных алгоритмов, которые будут искать пять ближайших к заказу водителей.
Производительность алгоритмов нужно сравнить, используя библиотеку [Benchmark](https://github.com/dotnet/BenchmarkDotNet).  
Скриншот(-ы) результатов сравнения нужно добавить в Readme.md файл в Git.
Все разработанные алгоритмы вы должны покрыть тестами, используя NUnit.

---

# Отчет о выполненном задании

### Архитектурное решение
Для решения задачи был выбран подход разделения способы хранения данных и алгоритма поиска.
Реализовано три типа контейнеров для хранения водителей, каждый из которых оптимизирован под определенные сценарии использования.
Для каждого контейнера разработаны специализированные алгоритмы поиска, эффективно использующие структуру данных.

Все алгоритмы поиска реализуют паттерн "стратегия", через базовый абстрактный класс BaseDriverSearchStrategy<TContainer>, что позволяет легко добавлять новые алгоритмы и переключаться между ними.

### Реализованные контейнеры и алгоритмы

**1. ListGrid - Словарь водителей**

**Описание:** Простейший контейнер, хранящий водителей в виде словаря `Dictionary<int, DriverOnMap>`, где ключ - уникальный ID водителя. Доступ к водителю выполняется за О(1), однако поиск по координатам требует полного перебора всех участников списка.

**Структура данных:**
- Словарь для хранения водителей по ID.
- Поиск по координатам путем перебора водителей.

**Алгоритмы:**

- **BruteForceAlhorithm (Линейный перебор)** - перебирает всех доступных водителей из списка, вычисляет Манхэттенское расстояние до каждого и с помощью приоритетной очереди отбирает N ближайших. Оптимален для любых карт, и малого количества водителей.

**2. ClassicGrid - Двумерная сетка 1:1**

**Описание:** Контейнер представляет собой двумерную сетку, где каждая клетка соответствует одной единице координат на карте. Под капотом используется одномерный массив, обернутый в класс `FastGrid<T>` (фасад) для повышения производительности, благодаря последовательному расположению данных в памяти.

**Структура данных:**
- Одномерный массив для хранения содержимого клеток по координатам
- Словарь для быстрого доступа к водителю по ID

**Алгоритмы:**

- **BFSAlgorithm (Поиск в ширину)** - классический алгоритм обхода графа в ширину (BFS). Начиная от точки заказа, волнообразно расширяется по соседним клеткам (↑ ↓ ← →), используя очередь и массив посещенных клеток. Оптимален, для небольших карт, когда водители находятся близко к точке заказа.
- **ManhattanRadialSearch (Ромбовидный послойный поиск)** - обходит клетки ромбовидными слоями на основе Манхэттенского расстояния (все клетки на расстояния от точки на 1, затем 2, 3, и т.д.). Ключевая оптимизация - вместо проверки всех клеток слоя, вычисляются граничные точки (вершины ромба), по которым строятся диагонали с автоматическим обрезанием за границами карты. Оптимален для карт среднего размера с средним распределением водителей.

**3. SpatialGrid - Секторальная сетка**

**Описание:** Улучшенная версия двумерной сетки, разбивающая карту на секторы (ячейки) фиксированного размера (например 10х10 клеток). Водители группируются по секторам и хранятся в словаре `Dictionary<GridCell, List<DriverOnMap>>`. Это позволяет проверять не отдельные клетки, а целые секторы, значительно сокращая количество проверок.

**Структура данных:**
- Словарь сектором со списками водителей в каждом
- Словарь для быстрого доступа к водителю по ID
- Ленивая инициализация списков для секторов (и чистка при опустошении ячейки после удаления водителя)

**Алгоритмы:**

- **SectorGridAlgorithm (Послойный поиск по секторам)** - выполняет обход секторов квадратными слоями от точки заказа. Проверяет всех водителей текущего слоя. Ключевая оптимизация: досрочное прерывание поиска. Если минимально возможное расстояние до следующего слоя больше, чем расстояние до самого дальнего из уже найденных водителей, поиск останавливается - в следующих слоях гарантированно не будет более близких водителей. Оптимален для больших карт с неравномерным распределением водителей и при использовании подходящего размера сектора.
